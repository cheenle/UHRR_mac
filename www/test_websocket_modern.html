<!DOCTYPE html>
<html>
<head>
    <title>WebSocket Connection Test</title>
</head>
<body>
    <h1>UHRR WebSocket Connection Test</h1>
    <div id="status">Testing connections...</div>
    <div id="results"></div>

    <script>
        const results = document.getElementById('results');
        const status = document.getElementById('status');
        
        function addResult(message, isSuccess = true) {
            const div = document.createElement('div');
            div.textContent = message;
            div.style.color = isSuccess ? 'green' : 'red';
            div.style.margin = '5px 0';
            results.appendChild(div);
        }
        
        // Use the same protocol as the current page
        const protocol = 'wss:';
        const baseUrl = `${protocol}//localhost:8443`;
        
        addResult(`Base URL: ${baseUrl}`);
        
        // Test Control WebSocket
        addResult('Testing Control WebSocket connection...');
        const wsControlTRX = new WebSocket(`${baseUrl}/WSCTRX`);
        
        wsControlTRX.onopen = function() {
            addResult('Control WebSocket connected successfully', true);
            status.textContent = 'Control connection successful';
            
            // Request initial status from radio
            addResult('Requesting initial frequency and mode...');
            wsControlTRX.send('getFreq:');
            wsControlTRX.send('getMode:');
        };
        
        wsControlTRX.onmessage = function(msg) {
            addResult(`Control message received: ${msg.data}`, true);
        };
        
        wsControlTRX.onclose = function() {
            addResult('Control WebSocket disconnected', false);
        };
        
        wsControlTRX.onerror = function(error) {
            addResult(`Control WebSocket error: ${error}`, false);
            status.textContent = 'Connection test failed';
        };
        
        // Test Audio RX WebSocket
        addResult('Testing Audio RX WebSocket connection...');
        const wsAudioRX = new WebSocket(`${baseUrl}/WSaudioRX`);
        
        wsAudioRX.onopen = function() {
            addResult('Audio RX WebSocket connected', true);
        };
        
        wsAudioRX.onclose = function() {
            addResult('Audio RX WebSocket disconnected', false);
        };
        
        wsAudioRX.onerror = function(error) {
            addResult(`Audio RX WebSocket error: ${error}`, false);
        };
        
        // Test Audio TX WebSocket
        addResult('Testing Audio TX WebSocket connection...');
        const wsAudioTX = new WebSocket(`${baseUrl}/WSaudioTX`);
        
        wsAudioTX.onopen = function() {
            addResult('Audio TX WebSocket connected', true);
        };
        
        wsAudioTX.onclose = function() {
            addResult('Audio TX WebSocket disconnected', false);
        };
        
        wsAudioTX.onerror = function(error) {
            addResult(`Audio TX WebSocket error: ${error}`, false);
        };
    </script>
</body>
</html>