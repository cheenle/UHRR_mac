<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ATUä½ç½®æµ‹è¯•</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
        }
        
        #test-tx-button {
            position: fixed;
            top: 200px;
            left: 300px;
            width: 80px;
            height: 40px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            z-index: 100;
        }
        
        #test-spectrum {
            position: fixed;
            top: 100px;
            left: 50px;
            width: 400px;
            height: 80px;
            background: linear-gradient(90deg, blue, green, yellow, red);
            border: 2px solid #333;
            z-index: 50;
        }
        
        #test-atu-status {
            position: fixed;
            width: 300px;
            height: 140px;
            background: rgba(0,0,0,0.8);
            border: 2px solid #4CAF50;
            border-radius: 15px;
            z-index: 1000;
            display: none;
        }
        
        .status-header {
            background: #4CAF50;
            color: white;
            padding: 3px;
            text-align: center;
            font-weight: bold;
            font-size: 12px;
        }
        
        .test-info {
            margin-top: 20px;
            padding: 10px;
            background: #f0f0f0;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <h1>ATUä½ç½®æµ‹è¯•é¡µé¢</h1>
    
    <!-- æ¨¡æ‹ŸTXæŒ‰é’® -->
    <button id="test-tx-button">TXæŒ‰é’®</button>
    
    <!-- æ¨¡æ‹Ÿé¢‘è°±æ˜¾ç¤º -->
    <div id="test-spectrum">é¢‘è°±æ˜¾ç¤ºåŒºåŸŸ</div>
    
    <!-- ATUçŠ¶æ€æ˜¾ç¤ºæ¡† -->
    <div id="test-atu-status">
        <div class="status-header">ATUå‘å°„çŠ¶æ€</div>
        <div style="padding: 10px; color: white;">
            å‘å°„åŠŸç‡: 25W<br>
            é©»æ³¢æ¯”: 1.2
        </div>
    </div>
    
    <div class="test-info">
        <h3>æµ‹è¯•è¯´æ˜ï¼š</h3>
        <p>è¿™ä¸ªé¡µé¢æ¨¡æ‹Ÿäº†ä¸»ç•Œé¢çš„å¸ƒå±€ï¼Œç”¨äºæµ‹è¯•ATUçŠ¶æ€æ˜¾ç¤ºæ¡†çš„å®šä½é€»è¾‘ã€‚</p>
        <p>ATUçŠ¶æ€æ˜¾ç¤ºæ¡†åº”è¯¥å®šä½åˆ°TXæŒ‰é’®å·¦è¾¹ã€é¢‘è°±æ˜¾ç¤ºä¸‹è¾¹ã€‚</p>
        <button onclick="testPositioning()">æµ‹è¯•å®šä½</button>
        <button onclick="reposition()">é‡æ–°å®šä½</button>
    </div>
    
    <script>
        function testPositioning() {
            const atuStatusDiv = document.getElementById('test-atu-status');
            const txButton = document.getElementById('test-tx-button');
            const spectrumDiv = document.getElementById('test-spectrum');
            
            // è·å–TXæŒ‰é’®çš„ä½ç½®å’Œå°ºå¯¸
            const txRect = txButton.getBoundingClientRect();
            
            // è·å–é¢‘è°±æ˜¾ç¤ºçš„ä½ç½®å’Œå°ºå¯¸
            const spectrumRect = spectrumDiv.getBoundingClientRect();
            
            // è®¡ç®—ATUçŠ¶æ€æ˜¾ç¤ºæ¡†çš„ä½ç½®
            // ç›®æ ‡ä½ç½®ï¼šä¸TXæŒ‰é’®åŒé«˜åº¦ï¼Œå·¦å³ä½ç½®ä¸é¢‘è°±æ˜¾ç¤ºæ¡†å¯¹é½
            let left = spectrumRect.left; // ä¸é¢‘è°±æ˜¾ç¤ºæ¡†å·¦å¯¹é½
            let top = txRect.top; // ä¸TXæŒ‰é’®åŒé«˜åº¦
            
            // å¦‚æœATUæ¡†ä¸é¢‘è°±æ˜¾ç¤ºæ¡†é‡å ï¼Œåˆ™è°ƒæ•´ä½ç½®
            if (top + 140 > spectrumRect.top && top < spectrumRect.bottom) {
                // å¦‚æœé‡å ï¼Œå°†ATUæ¡†æ”¾åœ¨é¢‘è°±æ˜¾ç¤ºæ¡†ä¸‹æ–¹
                top = spectrumRect.bottom + 10;
            }
            
            // è¾¹ç•Œæ£€æŸ¥
            const viewportWidth = window.innerWidth;
            const viewportHeight = window.innerHeight;
            
            if (left < 10) left = 10;
            if (left + 300 > viewportWidth) left = viewportWidth - 310;
            if (top < 10) top = 10;
            if (top + 140 > viewportHeight) top = viewportHeight - 150;
            
            // åº”ç”¨ä½ç½®
            atuStatusDiv.style.left = left + 'px';
            atuStatusDiv.style.top = top + 'px';
            atuStatusDiv.style.display = 'block';
            
            console.log('ğŸ“ ATUçŠ¶æ€æ˜¾ç¤ºæ¡†ä½ç½®:', { left, top });
            console.log('ğŸ“ TXæŒ‰é’®ä½ç½®:', { left: txRect.left, top: txRect.top });
            console.log('ğŸ“ é¢‘è°±æ˜¾ç¤ºä½ç½®:', { bottom: spectrumRect.bottom });
            
            alert(`ATUçŠ¶æ€æ˜¾ç¤ºæ¡†å·²å®šä½åˆ°ï¼š\nleft: ${left}px\ntop: ${top}px`);
        }
        
        function reposition() {
            const atuStatusDiv = document.getElementById('test-atu-status');
            atuStatusDiv.style.display = 'none';
            setTimeout(testPositioning, 100);
        }
        
        // é¡µé¢åŠ è½½åè‡ªåŠ¨æµ‹è¯•
        window.addEventListener('load', () => {
            setTimeout(testPositioning, 500);
        });
    </script>
</body>
</html>