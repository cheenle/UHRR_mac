# ATU功率和驻波比监控系统

## 概述

ATU功率和驻波比监控系统是一个专门用于监控天线调谐器（ATU）性能的Web界面。它提供实时功率输出、驻波比（SWR）、传输效率等关键参数的监控和告警功能。

## 功能特性

### 核心功能
- **实时数据监控**: 实时显示发射功率、驻波比、最大功率和传输效率
- **历史趋势图表**: 可视化显示功率和SWR的历史变化趋势
- **智能告警系统**: 根据预设阈值自动触发告警
- **设备状态指示**: 清晰的连接状态和通信状态指示
- **配置管理**: 支持设备IP、端口、告警阈值等参数配置

### 监控参数
- **发射功率 (Forward Power)**: 当前发射功率，单位：瓦特(W)
- **驻波比 (SWR)**: 天线系统的驻波比，反映匹配状态
- **最大功率 (Max Power)**: 设备支持的最大功率
- **传输效率 (Efficiency)**: 实际功率与最大功率的比值，百分比(%)

### 告警机制
- **SWR告警**: 当SWR超过设定阈值时触发告警
- **功率告警**: 当功率超过安全阈值时触发告警
- **效率告警**: 当传输效率过低时触发告警

## 使用方法

### 访问方式
1. 从主界面点击S表图标进入ATU监控页面
2. 直接访问URL: `/atu_monitor.html`

### 连接设备
1. **手动连接**: 输入ATU设备IP和端口，点击"连接设备"
2. **自动连接**: 点击"自动连接"，系统会自动扫描常见端口
3. **配置保存**: 设置完成后可保存配置，下次自动加载

### 监控界面
- **状态栏**: 显示连接状态和设备信息
- **数据卡片**: 四个主要参数的实时显示，颜色表示状态
- **趋势图表**: 功率和SWR的历史变化趋势
- **告警面板**: 系统告警信息显示
- **配置面板**: 设备参数配置

## 技术规格

### 通信协议
- **协议**: WebSocket
- **端口**: 默认60001 (可配置)
- **数据格式**: 二进制数据包
- **命令**: 
  - 同步命令: 0xFF 0x01 0x00
  - 电表数据: 0xFF 0x02 [长度] [数据]

### 数据解析
数据包格式 (电表数据):
```
[0xFF, 0x02, 0x07, 0x00, SWR_L, SWR_H, FWD_L, FWD_H, MAX_L, MAX_H]
```
- SWR: 字节4-5 (小端序)
- 正向功率: 字节6-7 (小端序)
- 最大功率: 字节8-9 (小端序)

### 默认配置
- 设备IP: 192.168.1.12
- WebSocket端口: 60001
- 更新频率: 1000ms
- SWR告警阈值: 2.0
- 历史数据长度: 100条

## 系统要求

### 硬件要求
- 支持WebSocket的ATU设备
- 网络连接

### 软件要求
- 现代Web浏览器 (支持WebSocket)
- JavaScript启用

## 故障排除

### 常见问题
1. **连接失败**
   - 检查设备IP和端口配置
   - 确认设备在线且WebSocket服务运行
   - 使用"自动连接"功能扫描端口

2. **无数据显示**
   - 检查设备是否正确发送数据
   - 查看浏览器控制台错误信息
   - 确认数据格式符合协议规范

3. **告警不触发**
   - 检查告警阈值设置
   - 确认数据解析正确
   - 查看告警面板状态

### 调试工具
- 使用`/atu_diagnostic.html`进行设备诊断
- 查看浏览器开发者工具控制台输出
- 检查网络连接状态

## 扩展功能

### 计划功能
- [ ] 数据导出功能
- [ ] 多设备监控支持
- [ ] 移动端适配优化
- [ ] 声音告警
- [ ] 数据统计分析

## 技术支持

如有问题或建议，请参考：
- 主系统文档: README.md
- ATU诊断工具: atu_diagnostic.html
- 系统配置界面: /CONFIG